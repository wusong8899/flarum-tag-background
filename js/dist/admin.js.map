{"version":3,"file":"admin.js","mappings":"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","sources":["webpack://@wusong8899/flarum-tag-background/webpack/bootstrap","webpack://@wusong8899/flarum-tag-background/webpack/runtime/compat get default export","webpack://@wusong8899/flarum-tag-background/webpack/runtime/define property getters","webpack://@wusong8899/flarum-tag-background/webpack/runtime/hasOwnProperty shorthand","webpack://@wusong8899/flarum-tag-background/external root \"flarum.reg.get('core', 'admin/app')\"","webpack://@wusong8899/flarum-tag-background/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@wusong8899/flarum-tag-background/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://@wusong8899/flarum-tag-background/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@wusong8899/flarum-tag-background/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@wusong8899/flarum-tag-background/external root \"flarum.reg.get('core', 'admin/components/ExtensionPage')\"","webpack://@wusong8899/flarum-tag-background/external root \"flarum.reg.get('core', 'common/components/Button')\"","webpack://@wusong8899/flarum-tag-background/external root \"flarum.reg.get('core', 'common/components/LoadingIndicator')\"","webpack://@wusong8899/flarum-tag-background/external root \"flarum.reg.get('core', 'tags/common/utils/sortTags')\"","webpack://@wusong8899/flarum-tag-background/external root \"flarum.reg.get('core', 'tags/common/helpers/tagIcon')\"","webpack://@wusong8899/flarum-tag-background/external root \"flarum.reg.get('core', 'common/components/Modal')\"","webpack://@wusong8899/flarum-tag-background/external root \"flarum.reg.get('core', 'common/utils/Stream')\"","webpack://@wusong8899/flarum-tag-background/./src/admin/components/SetBackgroundModal.tsx","webpack://@wusong8899/flarum-tag-background/./src/admin/components/SettingsPage.tsx","webpack://@wusong8899/flarum-tag-background/./src/admin/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'admin/app');","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'admin/components/ExtensionPage');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Button');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/LoadingIndicator');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'tags/common/utils/sortTags');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'tags/common/helpers/tagIcon');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Modal');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/Stream');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport app from 'flarum/admin/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport Stream from 'flarum/common/utils/Stream';\nexport default class SetBackgroundModal extends Modal {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"loading\", false);\n    _defineProperty(this, \"tagData\", void 0);\n    _defineProperty(this, \"backgroundUrl\", void 0);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loading = false;\n    this.tagData = this.attrs.tagData;\n    this.backgroundUrl = Stream(this.tagData.attribute('wusong8899BackgroundURL'));\n  }\n  className() {\n    return 'Modal--small';\n  }\n  title() {\n    return app.translator.trans('wusong8899-tag-background.admin.set-background');\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(\"div\", {\n      className: \"Form\"\n    }, m(\"div\", {\n      className: \"Form-group\",\n      style: \"text-align: center;\"\n    }, m(\"div\", {\n      className: \"ModuleItemSettingsLabel\"\n    }, app.translator.trans('wusong8899-tag-background.admin.item-background-url')), m(\"input\", {\n      maxlength: \"200\",\n      className: \"FormControl\",\n      bidi: this.backgroundUrl\n    })), m(\"div\", {\n      className: \"Form-group\",\n      style: \"text-align: center;\"\n    }, Button.component({\n      style: 'min-width:66px;',\n      className: 'Button Button--primary',\n      disabled: this.loading,\n      onclick: () => {\n        this.saveData();\n      }\n    }, app.translator.trans('wusong8899-tag-background.admin.save')), \"\\xA0\", Button.component({\n      style: 'min-width:66px;background: rgba(0,0,0,0.1);',\n      className: 'Button',\n      disabled: this.loading,\n      onclick: () => {\n        this.hide();\n      }\n    }, app.translator.trans('wusong8899-tag-background.admin.cancel')))));\n  }\n  saveData() {\n    this.loading = true;\n    const backgroundUrl = this.backgroundUrl();\n    const tagID = this.tagData.id();\n    app.request({\n      url: \"\".concat(app.forum.attribute('apiUrl'), \"/tagBackgroundSetImage\"),\n      method: 'POST',\n      body: {\n        tagID,\n        backgroundUrl\n      }\n    }).then(result => {\n      this.hide();\n      // pushPayload expects a JSON:API payload; the controller returns Tag payload\n      app.store.pushPayload(result);\n      // Ensure store is updated; force redraw\n      // eslint-disable-next-line no-console\n      console.log(app.store.getById('tags', tagID));\n      m.redraw();\n    }).catch(() => {\n      this.loading = false;\n    });\n  }\n}\n_defineProperty(SetBackgroundModal, \"isDismissibleViaBackdropClick\", false);\n_defineProperty(SetBackgroundModal, \"isDismissibleViaCloseButton\", true);\nflarum.reg.add('wusong8899-tag-background', 'admin/components/SetBackgroundModal', SetBackgroundModal);","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport app from 'flarum/admin/app';\nimport ExtensionPage from 'flarum/admin/components/ExtensionPage';\nimport Button from 'flarum/common/components/Button';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport sortTags from 'flarum/tags/common/utils/sortTags';\nimport tagIcon from 'flarum/tags/common/helpers/tagIcon';\nimport SetBackgroundModal from './SetBackgroundModal';\nexport default class SettingsPage extends ExtensionPage {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"loading\", false);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loading = true;\n\n    // Load tag list with parents\n    // @ts-ignore tagList is provided by flarum/tags\n    app.tagList.load(['parent']).then(() => {\n      this.loading = false;\n      m.redraw();\n    });\n  }\n  content(vnode) {\n    if (this.loading) {\n      return m(LoadingIndicator, null);\n    }\n    const tags = sortTags(\n    // @ts-ignore tags model provided by flarum/tags\n    app.store.all('tags').filter(tag => !tag.parent()));\n    return m(\"div\", {\n      className: \"tagBackgroundSettingsGroups\",\n      style: \"text-align: left;padding: 20px;\"\n    }, tags.map(tagData => {\n      const wusong8899BackgroundURL = tagData.attribute('wusong8899BackgroundURL');\n      const tagBackgroundImageStyle = \"background:url(\".concat(wusong8899BackgroundURL, \");background-size: cover;background-position: center;background-repeat: no-repeat;\");\n      return m(\"div\", {\n        className: \"tagBackgroundContainer\"\n      }, m(\"div\", {\n        className: \"tagBackgroundItemContainer\"\n      }, tagIcon(tagData), m(\"span\", {\n        className: \"tagBackgroundItemName TagListItem-name\"\n      }, tagData.name()), m(\"div\", {\n        style: \"padding-top: 10px;display: flex;justify-content: center;align-items: center;\"\n      }, wusong8899BackgroundURL && m(\"div\", {\n        style: tagBackgroundImageStyle,\n        className: \"tagBackgroundImage\",\n        onclick: () => app.modal.show(SetBackgroundModal, {\n          tagData\n        })\n      }), !wusong8899BackgroundURL && m(\"div\", {\n        className: \"tagBackgroundImage\"\n      }, Button.component({\n        style: 'min-width: 66px;font-size: 12px;font-weight: normal;',\n        className: 'Button',\n        onclick: () => {\n          app.modal.show(SetBackgroundModal, {\n            tagData\n          });\n        }\n      }, app.translator.trans('wusong8899-tag-background.admin.set-background'))))));\n    }));\n  }\n}\nflarum.reg.add('wusong8899-tag-background', 'admin/components/SettingsPage', SettingsPage);","import app from 'flarum/admin/app';\nimport SettingsPage from './components/SettingsPage';\napp.initializers.add('wusong8899-tag-background', () => {\n  app.extensionData.for('wusong8899-tag-background').registerPage(SettingsPage);\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","reg","_typeof","Symbol","iterator","constructor","_defineProperty","e","r","t","i","toPrimitive","TypeError","String","toPropertyKey","value","configurable","writable","SetBackgroundModal","super","arguments","this","oninit","vnode","loading","tagData","attrs","backgroundUrl","attribute","className","title","trans","content","m","style","maxlength","bidi","disabled","onclick","saveData","hide","tagID","id","url","concat","method","body","then","result","pushPayload","console","log","getById","redraw","catch","add","SettingsPage","load","tags","all","filter","tag","parent","map","wusong8899BackgroundURL","tagBackgroundImageStyle","name","show","for","registerPage"],"sourceRoot":""}