(()=>{var t={n:a=>{var n=a&&a.__esModule?()=>a.default:()=>a;return t.d(n,{a:n}),n},d:(a,n)=>{for(var o in n)t.o(n,o)&&!t.o(a,o)&&Object.defineProperty(a,o,{enumerable:!0,get:n[o]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a)};(()=>{"use strict";const a=flarum.reg.get("core","admin/app");var n=t.n(a);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function e(t,a,n){return(a=function(t){var a=function(t){if("object"!=o(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var n=a.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(a)?a:a+""}(a))in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t}const r=flarum.reg.get("core","admin/components/ExtensionPage");var s=t.n(r);const i=flarum.reg.get("core","common/components/Button");var c=t.n(i);const g=flarum.reg.get("core","common/components/LoadingIndicator");var l=t.n(g);const u=flarum.reg.get("core","tags/common/utils/sortTags");var d=t.n(u);const p=flarum.reg.get("core","tags/common/helpers/tagIcon");var b=t.n(p);const f=flarum.reg.get("core","common/components/Modal");var h=t.n(f);const k=flarum.reg.get("core","common/utils/Stream");var v=t.n(k);class y extends(h()){constructor(){super(...arguments),e(this,"loading",!1),e(this,"tagData",void 0),e(this,"backgroundUrl",void 0)}oninit(t){super.oninit(t),this.loading=!1,this.tagData=this.attrs.tagData,this.backgroundUrl=v()(this.tagData.attribute("wusong8899BackgroundURL"))}className(){return"Modal--small"}title(){return n().translator.trans("wusong8899-tag-background.admin.set-background")}content(){return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group",style:"text-align: center;"},m("div",{className:"ModuleItemSettingsLabel"},n().translator.trans("wusong8899-tag-background.admin.item-background-url")),m("input",{maxlength:"200",className:"FormControl",bidi:this.backgroundUrl})),m("div",{className:"Form-group",style:"text-align: center;"},c().component({style:"min-width:66px;",className:"Button Button--primary",disabled:this.loading,onclick:()=>{this.saveData()}},n().translator.trans("wusong8899-tag-background.admin.save")),"Â ",c().component({style:"min-width:66px;background: rgba(0,0,0,0.1);",className:"Button",disabled:this.loading,onclick:()=>{this.hide()}},n().translator.trans("wusong8899-tag-background.admin.cancel")))))}saveData(){this.loading=!0;const t=this.backgroundUrl(),a=this.tagData.id();n().request({url:"".concat(n().forum.attribute("apiUrl"),"/tagBackgroundSetImage"),method:"POST",body:{tagID:a,backgroundUrl:t}}).then(t=>{this.hide(),n().store.pushPayload(t),console.log(n().store.getById("tags",a)),m.redraw()}).catch(()=>{this.loading=!1})}}e(y,"isDismissibleViaBackdropClick",!1),e(y,"isDismissibleViaCloseButton",!0),flarum.reg.add("wusong8899-tag-background","admin/components/SetBackgroundModal",y);class w extends(s()){constructor(){super(...arguments),e(this,"loading",!1)}oninit(t){super.oninit(t),this.loading=!0,n().tagList.load(["parent"]).then(()=>{this.loading=!1,m.redraw()})}content(t){if(this.loading)return m(l(),null);const a=d()(n().store.all("tags").filter(t=>!t.parent()));return m("div",{className:"tagBackgroundSettingsGroups",style:"text-align: left;padding: 20px;"},a.map(t=>{const a=t.attribute("wusong8899BackgroundURL"),o="background:url(".concat(a,");background-size: cover;background-position: center;background-repeat: no-repeat;");return m("div",{className:"tagBackgroundContainer"},m("div",{className:"tagBackgroundItemContainer"},b()(t),m("span",{className:"tagBackgroundItemName TagListItem-name"},t.name()),m("div",{style:"padding-top: 10px;display: flex;justify-content: center;align-items: center;"},a&&m("div",{style:o,className:"tagBackgroundImage",onclick:()=>n().modal.show(y,{tagData:t})}),!a&&m("div",{className:"tagBackgroundImage"},c().component({style:"min-width: 66px;font-size: 12px;font-weight: normal;",className:"Button",onclick:()=>{n().modal.show(y,{tagData:t})}},n().translator.trans("wusong8899-tag-background.admin.set-background"))))))}))}}flarum.reg.add("wusong8899-tag-background","admin/components/SettingsPage",w),n().initializers.add("wusong8899-tag-background",()=>{n().extensionData.for("wusong8899-tag-background").registerPage(w)})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map