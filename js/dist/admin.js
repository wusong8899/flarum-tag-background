(()=>{var t={n:a=>{var n=a&&a.__esModule?()=>a.default:()=>a;return t.d(n,{a:n}),n},d:(a,n)=>{for(var o in n)t.o(n,o)&&!t.o(a,o)&&Object.defineProperty(a,o,{enumerable:!0,get:n[o]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a)};(()=>{"use strict";const a=flarum.core.compat["admin/app"];var n=t.n(a);function o(t,a){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},o(t,a)}function r(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,o(t,a)}const e=flarum.core.compat["admin/components/ExtensionPage"];var i=t.n(e);const s=flarum.core.compat["common/components/Button"];var c=t.n(s);const l=flarum.core.compat["common/components/LoadingIndicator"];var u=t.n(l);const g=flarum.core.compat["tags/common/utils/sortTags"];var d=t.n(g);const p=flarum.core.compat["tags/common/helpers/tagIcon"];var f=t.n(p);const h=flarum.core.compat["common/components/Modal"];var b=t.n(h);const v=flarum.core.compat["common/utils/Stream"];var k=t.n(v),y=function(t){function a(){for(var a,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=t.call.apply(t,[this].concat(o))||this).loading=!1,a.tagData=void 0,a.backgroundUrl=void 0,a}r(a,t);var o=a.prototype;return o.oninit=function(a){t.prototype.oninit.call(this,a),this.loading=!1,this.tagData=this.attrs.tagData,this.backgroundUrl=k()(this.tagData.attribute("wusong8899BackgroundURL"))},o.className=function(){return"Modal--small"},o.title=function(){return n().translator.trans("wusong8899-tag-background.admin.set-background")},o.content=function(){var t=this;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group",style:"text-align: center;"},m("div",{className:"ModuleItemSettingsLabel"},n().translator.trans("wusong8899-tag-background.admin.item-background-url")),m("input",{maxlength:"200",className:"FormControl",bidi:this.backgroundUrl})),m("div",{className:"Form-group",style:"text-align: center;"},c().component({style:"min-width:66px;",className:"Button Button--primary",disabled:this.loading,onclick:function(){t.saveData()}},n().translator.trans("wusong8899-tag-background.admin.save")),"Â ",c().component({style:"min-width:66px;background: rgba(0,0,0,0.1);",className:"Button",disabled:this.loading,onclick:function(){t.hide()}},n().translator.trans("wusong8899-tag-background.admin.cancel")))))},o.saveData=function(){var t=this;this.loading=!0;var a=this.backgroundUrl(),o=this.tagData.id();n().request({url:n().forum.attribute("apiUrl")+"/tagBackgroundSetImage",method:"POST",body:{tagID:o,backgroundUrl:a}}).then(function(a){t.hide(),n().store.pushPayload(a),console.log(n().store.getById("tags",o)),m.redraw()}).catch(function(){t.loading=!1})},a}(b());y.isDismissibleViaBackdropClick=!1,y.isDismissibleViaCloseButton=!0;var w=function(t){function a(){for(var a,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=t.call.apply(t,[this].concat(o))||this).loading=!1,a}r(a,t);var o=a.prototype;return o.oninit=function(a){var o=this;t.prototype.oninit.call(this,a),this.loading=!0,n().tagList.load(["parent"]).then(function(){o.loading=!1,m.redraw()})},o.content=function(t){if(this.loading)return m(u(),null);var a=d()(n().store.all("tags").filter(function(t){return!t.parent()}));return m("div",{className:"tagBackgroundSettingsGroups",style:"text-align: left;padding: 20px;"},a.map(function(t){var a=t.attribute("wusong8899BackgroundURL"),o="background:url("+a+");background-size: cover;background-position: center;background-repeat: no-repeat;";return m("div",{className:"tagBackgroundContainer"},m("div",{className:"tagBackgroundItemContainer"},f()(t),m("span",{className:"tagBackgroundItemName TagListItem-name"},t.name()),m("div",{style:"padding-top: 10px;display: flex;justify-content: center;align-items: center;"},a&&m("div",{style:o,className:"tagBackgroundImage",onclick:function(){return n().modal.show(y,{tagData:t})}}),!a&&m("div",{className:"tagBackgroundImage"},c().component({style:"min-width: 66px;font-size: 12px;font-weight: normal;",className:"Button",onclick:function(){n().modal.show(y,{tagData:t})}},n().translator.trans("wusong8899-tag-background.admin.set-background"))))))}))},a}(i());n().initializers.add("wusong8899-tag-background",function(){n().extensionData.for("wusong8899-tag-background").registerPage(w)})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map