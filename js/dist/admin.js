(()=>{var t={n:a=>{var e=a&&a.__esModule?()=>a.default:()=>a;return t.d(e,{a:e}),e},d:(a,e)=>{for(var n in e)t.o(e,n)&&!t.o(a,n)&&Object.defineProperty(a,n,{enumerable:!0,get:e[n]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a)};(()=>{"use strict";flarum.reg.get("core","extend");const a=flarum.reg.get("core","components/ExtensionPage");var e=t.n(a);const n=flarum.reg.get("core","components/Button");var o=t.n(n);flarum.reg.get("core","common/components/Switch");const r=flarum.reg.get("core","components/LoadingIndicator");var s=t.n(r);const i=flarum.reg.get("core","tags/utils/sortTags");var l=t.n(i);const g=flarum.reg.get("core","tags/helpers/tagIcon");var c=t.n(g);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function d(t,a,e){return(a=function(t){var a=function(t){if("object"!=u(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var e=a.call(t,"string");if("object"!=u(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(a)?a:a+""}(a))in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}const p=flarum.reg.get("core","components/Modal");var b=t.n(p);const f=flarum.reg.get("core","utils/Stream");var h=t.n(f);class k extends(b()){oninit(t){super.oninit(t),this.loading=!1,this.tagData=this.attrs.tagData,this.backgroundUrl=h()(this.tagData.attribute("wusong8899BackgroundURL"))}className(){return"Modal--small"}title(){return app.translator.trans("wusong8899-tag-background.admin.set-background")}content(){return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group",style:"text-align: center;"},m("div",{className:"ModuleItemSettingsLabel"},app.translator.trans("wusong8899-tag-background.admin.item-background-url")),m("input",{maxlength:"200",className:"FormControl",bidi:this.backgroundUrl})),m("div",{className:"Form-group",style:"text-align: center;"},o().component({style:"min-width:66px;",className:"Button Button--primary",disabled:this.loading,onclick:()=>{this.saveData()}},app.translator.trans("wusong8899-custom-index-page.lib.save")),"Â ",o().component({style:"min-width:66px;background: rgba(0,0,0,0.1);",className:"Button",disabled:this.loading,onclick:()=>{this.hide()}},app.translator.trans("wusong8899-custom-index-page.lib.cancel")))))}saveData(){this.loading=!0;const t=this.backgroundUrl(),a=this.tagData.id();app.request({url:"".concat(app.forum.attribute("apiUrl"),"/tagBackgroundSetImage"),method:"POST",body:{tagID:a,backgroundUrl:t}}).then(t=>{this.hide(),app.store.pushPayload(t);let e=app.store.getById("tags",a);console.log(e),m.redraw()}).catch(t=>{this.loading=!1})}}let y;d(k,"isDismissibleViaBackdropClick",!1),d(k,"isDismissibleViaCloseButton",!0),flarum.reg.add("wusong8899-tag-background","admin/components/SetBackgroundModal",k);class v extends(e()){oninit(t){super.oninit(t),this.loading=!0,app.tagList.load(["parent"]).then(()=>{y=app.store.all("tags"),this.loading=!1,m.redraw()})}content(){if(this.loading)return m(s(),null);const t=l()(app.store.all("tags").filter(t=>!t.parent()));return[m("div",{className:"tagBackgroundSettingsGroups",style:"text-align: left;padding: 20px;"},t.map(t=>{let a=t.attribute("wusong8899BackgroundURL"),e="background:url("+a+");background-size: cover;background-position: center;background-repeat: no-repeat;";return t.id(),m("div",{className:"tagBackgroundContainer"},m("div",{className:"tagBackgroundItemContainer"},c()(t),m("span",{className:"tagBackgroundItemName TagListItem-name"},t.name()),m("div",{style:"padding-top: 10px;display: flex;justify-content: center;align-items: center;"},a&&m("div",{style:e,className:"tagBackgroundImage",onclick:a=>app.modal.show(k,{tagData:t})}),!a&&m("div",{className:"tagBackgroundImage"},o().component({style:"min-width: 66px;font-size: 12px;font-weight: normal;",className:"Button",onclick:()=>{app.modal.show(k,{tagData:t})}},app.translator.trans("wusong8899-tag-background.admin.set-background"))))))}))]}}flarum.reg.add("wusong8899-tag-background","admin/components/SettingsPage",v),app.initializers.add("wusong8899-tag-background",()=>{app.extensionData.for("wusong8899-tag-background").registerPage(v)})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map